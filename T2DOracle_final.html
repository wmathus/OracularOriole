<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- This line adjust the screen size to fit whatever device -->
    <title>T2D Oracle</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"> 
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script> <!-- Imports Bootstrap. Bootstrap is a free front-end framework for faster and easier web development, it also gives you the ability to easily create responsive designs. It uses javascript as well as html and CSS can also be used to develop backend functions-->
  <!-- Below you are going to see each class defined in a coded way with letters and a number that is basically the position and size for where that object will appear and how big it'll be. Ex: mt-4 i commented what it does after the CSS bit. Wait for it... -->
    <style> /* These are the CSS code for styling */
        /* Full-screen sidebar as main page */
        .full-screen-sidebar {
            height: 100vh;
            width: 100%;
            position: fixed;
            top: 0;
            left: 0;
            color: #f4912f;
            background-color: white;
            z-index: 1050;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            transition: transform 0.6s ease-in-out;
            overflow-y: auto;
        }

        /* Hide sidebar smoothly */
        .hidden {
            transform: translateY(-100%);
        }

        /* Main content starts after sidebar */
        .main-content {
            padding: 20px;
        }

        /* Back to Main Page button */
        .back-button {
            position: fixed;
            top: 10px;
            left: 10px;
            z-index: 1100;
            display: none;
        }

        /* Ensure smooth scrolling */
        html, body {
            scroll-behavior: smooth;
        }
       .btn-primary {
            background-color: light-blue;
            color: orange;
       }
    </style>
</head>
<body>

    <!-- Sidebar (Main Page) -->
    <div class="full-screen-sidebar" id="sidebar">
        <div class="container text-center">
            <h2 class="mt-4">Discover the relationship between <i>type 2 diabetes</i>, its phenotypes, and ancestry</h2> <!-- Legendary! mt-number is a Bootstrap code that adjusts how the heading will appear. m is for margin, t is for margin top. 4 is the spacer width, >4 would be wider. (More information in: https://getbootstrap.com/docs/5.0/utilities/spacing/#notation). If we decide not to use bootstrap we can use CSS to do this bit. -->
            <p>Use the controls below to adjust filters and search SNPs.</p>
            <form method="post"> <!-- The method defines whatever input is to be sent to be processed by the web server app. This is tricky because we need to connect this to the backend which i can get to that later hopefully. We'll just delete it if it doesn't work out.-->
                <h4 class="mt-3">Controls</h4> <!-- t is for top -->
                <div class="mb-3"> <!-- b is for bottom -->
                    <label class="form-label">P-value Threshold</label> <!-- https://getbootstrap.com/docs/4.0/components/forms/ -->
                    <input type="number" step="any" name="p_value" 
                           class="form-control" 
                           value="{{ p_value_threshold }}">
                </div> <!-- We could change this to a slidebar. Holding my horses ('-_-) -->

                <hr>
                <!-- Updated Search SNPs Section -->
                <h4>Search SNPs</h4> 
                <div class="row g-2"> <!-- g is for gutters see: https://getbootstrap.com/docs/5.0/layout/gutters/ -->
                    <!-- Search Type Dropdown -->
                    <div class="col-md-6">
                        <label class="form-label">Search by:</label>
                        <select id="searchType" class="form-select"> 
                        <!-- form-select, Dropdown: https://getbootstrap.com/docs/5.0/forms/select/ -->  
                            <option value="snp">SNP ID</option>
                            <option value="gene">Gene Name</option>
                            <option value="gene">Chromosomal Location</option>
                        </select>
                    </div>

                    <!-- SNP Search Bar -->
                    <div class="col-md-6"> <!-- More bootstrap lingo :P (https://getbootstrap.com/docs/5.0/layout/grid/#auto-layout-columns) -->
                        <label class="form-label">Search</label>
                        <input type="text" name="search_term" class="form-control" placeholder="eg. rs35261542-A; CDKAL1; 6p22.3 ">
                    </div>
                </div>
                <!-- SNP Search Button -->
                <button type="submit" class="btn btn-primary mt-3">Search</button>
            </form>

            {% if search_results %}
                <div class="mt-3">
                    <h5>Search Results</h5>
                    {{ search_results|safe }}
                </div>
            {% endif %}

            <div class="mt-3"> <!-- API time! >:) -->
                <small>Last Updated: {{ last_update }}</small>
            </div>

            <!-- Continue button -->
            <button class="btn btn-success mt-4" onclick="hideSidebar()">Continue to Analysis ↓</button> <!-- Java Script :) see below -->
        </div>
    </div>

    <!-- Back to Main Page Button -->
    <button class="btn btn-secondary back-button" id="backButton" onclick="showSidebar()">← Back to Main Page</button> <!-- Java Script :) see below -->

    <!-- Main Content -->
    <div class="container main-content" id="main-content">
        <h1 class="mt-3">Type 2 Diabetes Genomic Statistics</h1>
        <p>{{ data_description }}</p> <!-- API time! >:) -->

        <ul class="nav nav-tabs"> <!-- As you can see we can add and delete tabs here -->
            <li class="nav-item"><a class="nav-link active" href="#snp" data-bs-toggle="tab">SNP Analysis</a></li>
            <li class="nav-item"><a class="nav-link" href="#pathway" data-bs-toggle="tab">Pathway Analysis</a></li>
            <li class="nav-item"><a class="nav-link" href="#population" data-bs-toggle="tab">Population Distribution</a></li> 
            <li class="nav-item"><a class="nav-link" href="#network" data-bs-toggle="tab">Gene Network</a></li>
        </ul>

        <div class="tab-content"> <!-- IGNORE! This is from the AI-->
            <!-- SNP Analysis Tab -->
            <div class="tab-pane active" id="snp">
                <h3 class="mt-3">SNP Analysis</h3>
                <div id="manhattan-plot"></div>
                <h4 class="mt-3">Significant SNPs</h4>
                {{ formatted_snps|safe }}
            </div>

            <!-- Pathway Analysis Tab --> <!-- IGNORE! This is from the AI-->
            <div class="tab-pane" id="pathway">
                <h3 class="mt-3">Pathway Analysis</h3>
                <div id="pathway-plot"></div>
            </div>

            <!-- Population Distribution Tab --> <!-- POPULATION STATISTICS, this is where the statistical functions go!!!! -->
            <div class="tab-pane" id="population">
                <h3 class="mt-3">Population Distribution</h3>
                <div id="distribution-plot"></div>

                <!-- Moved Population Type Dropdown Here -->
                <div class="row mt-3">
                    <div class="col-md-6">
                        <label class="form-label">Select Population Type:</label>
                        <select name="population_type" class="form-select">
                            <option value="all" selected>All Populations</option>
                            <option value="european">European</option>
                            <option value="african">African</option>
                            <option value="southasian">South Asian</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Gene Network Tab --> <!-- IGNORE! This is from the AI-->
            <div class="tab-pane" id="network">
                <h3 class="mt-3">Gene Network</h3>
                <div id="network-plot"></div>
            </div>
        </div>

        <!-- Population Search Button --> 
        <div class="text-center mt-5"><!-- This is the button that should call upon the function-->
            <a href="population_search.html" class="btn btn-info btn-lg">Explore Population Statistics</a>
        </div>

        <hr class="mt-5"> <!-- API time >:) or just add href = hyperlink reference -->
        <h3>Data Sources and Citations</h3>
        {% for source, citation in citations.items() %}
            <p><strong>{{ source }}:</strong> {{ citation }}</p>
        {% endfor %}
    </div>

    <!-- JavaScript -->
    <script> <!-- Simple dimple java code (._.) --> <!-- I'de need time to translate this bit to python if necessary. I'll add more commments here soon -->
        function hideSidebar() {
            let sidebar = document.getElementById("sidebar");
            let backButton = document.getElementById("backButton");

            sidebar.classList.add("hidden");

            setTimeout(() => {
                backButton.style.display = "block";
                document.getElementById("main-content").scrollIntoView({ behavior: "smooth" });
            }, 600);
        }

        function showSidebar() {
            let sidebar = document.getElementById("sidebar");
            let backButton = document.getElementById("backButton");

            sidebar.classList.remove("hidden");
            backButton.style.display = "none";
            window.scrollTo({ top: 0, behavior: "smooth" });
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
